<!DOCTYPE html>
<html lang="en-US" class="h-100">
  <head>
    <meta charset="UTF-8">
    <title>How to Secure your NodeJs Express Javascript Application - part 1  - SmartScanner</title>
    <meta name="description" content="Tips to secure Nodejs application. npm security best practices. Protecting JavaScript and express.js web applications againsts security vulnerabili...">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#137752">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="/assets/img/logo.png">
    <link rel="icon" type="image/svg+xml" href="/assets/img/logo.svg">
    <link rel="alternate icon" type="image/png" href="/assets/img/logo.png">
    <meta property="og:title" content="How to Secure your NodeJs Express Javascript Application - part 1">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://www.thesmartscanner.com/blog/how-to-secure-your-nodejs-express-javascript-application-part-1">
    <meta property="og:image" content="/assets/img/express-security.png">
    <meta property="og:description" content="Tips to secure Nodejs application. npm security best practices. Protecting JavaScript and express.js web applications againsts security vulnerabilities" />
    <link rel="canonical" href="https://www.thesmartscanner.com/blog/how-to-secure-your-nodejs-express-javascript-application-part-1" />
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@TheSmartScanner">
    <meta name="twitter:title" content="How to Secure your NodeJs Express Javascript Application - part 1">
    <meta name="twitter:url" content="https://www.thesmartscanner.com/blog/how-to-secure-your-nodejs-express-javascript-application-part-1" />
    <meta name="twitter:description" content="Tips to secure Nodejs application. npm security best practices. Protecting JavaScript and express.js web applications againsts security vulnerabilities">
    
    <meta name="twitter:image" content="https://www.thesmartscanner.com/assets/img/express-security.png">    
    
    
    <meta name="robots" content="index, follow">
    
    
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LBRWV5BDLZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  const _arch=()=>{const n=navigator.userAgent;return-1!=n.indexOf("WOW64")||-1!=n.indexOf("Win64")?"64bit":"32bit"};

  gtag('config', 'G-LBRWV5BDLZ', {
    'custom_map': {'dimension1': 'arch'}
  });

  gtag('event', 'arch_dimension', {'arch': _arch()});
</script>


    <link rel="stylesheet" href="/assets/css/style.css">
    
	<link rel="stylesheet" href="/assets/css/prism.css">
    
  </head>
  <body class="sans-serif lh-easy flex flex-column">
    <header role="banner" class=" black overflow-hidden flex-shrink-none">
      <nav class="w-100 mw8 flex justify-between items-center pa3 center">
        <a class="w-25 flex items-center link" href="/#" title="Home">
          <img src="/assets/img/logo_opaque.svg" class="dib w2 h2" width="2rem" height="2rem" alt="SmartScanner Logo">
        </a>
        <div class="w-75 tr black">
          <a class="f6 f5-ns dib mr3 mr4-ns black link bb-animate" href="/pricing">Pricing</a>
          <a class="f6 f5-ns dib mr3 mr4-ns black link bb-animate" href="/features">Features</a>
          <a class="f6 f5-ns dib pa1 ba br1 black link hover-bg-light-green" href="/download">Download</a>
        </div>
      </nav>      
     </header>

    <main class="w-100 mw7 center pv4 flex-grow">
  <article>
    <div>
      <div class="h5 w-100 mb2 cover" style="background-image: url(/assets/img/express-security.png); background-position:center center"></div>
      <div class="flex justify-between f6 gray i mb2 ph3">
        <span><a href="/blog/" class="link gray hover-dark-green">Blog</a><span class="mh2">/</span></span>
        <span onClick="share()" class="gray hover-dark-green cursor-pointer dn-l">
<svg height="21" viewBox="0 0 21 21" width="21" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" transform="translate(3 3)"><path d="m11.5 4.5-3.978-4-4.022 4"></path><path d="m7.522.521v11.979"></path><path d="m4.5 7.5h-2c-1.1045695 0-2 .8954305-2 2v4c0 1.1045695.8954305 2 2 2h10c1.1045695 0 2-.8954305 2-2v-4c0-1.1045695-.8954305-2-2-2h-2"></path></g></svg>
</span>

<script>
async function share() {
  let url = "https://www.TheSmartScanner.com/blog/how-to-secure-your-nodejs-express-javascript-application-part-1" || document.URL
  let title = "How to Secure your NodeJs Express Javascript Application - part 1" || document.title
  let text = `Tips to secure Nodejs application. npm security best practices. Protecting JavaScript and express.js web applications againsts security vulnerabilities`
  
  try {
    await navigator.share({
      url: url,
      title: title,
      text: text
    })
  } catch(err) {
    console.log('sharing not supported', err)
  }
}
</script>
        <span><time datetime="2021-12-29" >29 December 2021</time></span>
      </div>
      <h1 class="mt0 ph3">How to Secure your NodeJs Express Javascript Application - part 1</h1>
        
    </div>
    <div class="ph3">
    <p>Express is a fast, unopinionated, and minimalist web framework for Node.js. It has been a de facto choice for creating a web-server application in Node.js. If you want to use Express in your application, you need to read this article.</p>

<p>Read the second part of this series on the below URL.</p>

<blockquote>
  <p><a href="https://www.thesmartscanner.com/blog/how-to-secure-your-nodejs-express-javascript-application-part-2">How to Secure your NodeJs Express Javascript Application - part 2</a></p>
</blockquote>

<p>Let’s see how you can make Express more secure.</p>

<h2 id="use-updated-express-version-and-any-other-npm-package">Use Updated Express Version (and any other npm package)</h2>
<p>Old versions of Express have vulnerabilities like <a href="https://www.thesmartscanner.com/vulnerability-list/web-server-path-traversal">Path traversal (CVE-2017-14849)</a>. The best practice is to use the latest stable packages to mitigate such vulnerabilities. You can use the <code>npm audit</code> command to find out known vulnerabilities in your Nodejs application. Then you can fix them by running the <code>npm audit fix</code> command. Make sure to get 0 vulnerabilities in the report of the npm audit command.</p>

<h2 id="secure-your-http-headers">Secure your HTTP Headers</h2>
<p>Proper HTTP headers can prevent security vulnerabilities like Cross-Site Scripting, Click-jacking, Packet sniffing and, information disclosure. It’s better not to use Express with its default HTTP headers.
Try the <a href="https://www.npmjs.com/package/helmet">Helmet</a> npm package for hardening the HTTP headers of your Express project. Below is a sample code.</p>

<pre><code class="language-Javascript">const express = require("express");
const helmet = require("helmet");

const app = express();

app.use(helmet());

// ...
</code></pre>
<p>Read the <a href="https://www.thesmartscanner.com/blog/complete-guide-to-http-headers-for-securing-websites-cheat-sheet">Complete guide to HTTP Headers</a> for more detailed information about HTTP Headers security.</p>

<h2 id="validate-input">Validate Input</h2>
<p>Hackers should find a way into your application and, request parameters are their first choice. All the injection vulnerabilities like <a href="https://www.thesmartscanner.com/vulnerability-list/sql-injection">SQL Injection</a>, <a href="https://www.thesmartscanner.com/vulnerability-list/os-command-execution">Command Injection</a>, <a href="https://www.thesmartscanner.com/vulnerability-list/expression-language-injection">Expression Language injection</a>, and many others occur when unvalidated user input is directly used in performing tasks.</p>

<p>Consider below code which gets your name in the <code>name</code> query parameter and displays it.</p>
<pre><code class="language-Javascript">const express = require('express')
const app = express()

app.get('/', function (request, response) {
 response.send('Hello ' + request.query.name)
})

app.listen(3000)
</code></pre>
<p>If you send a request like <code>http://localhost:3000/?name[foo]=bar</code> then you will receive an Object instead of a String name. This is an attack known as HTTP Parameter Pollution (HPP). It can be very scary when working with a no-SQL database like MongoDB.</p>

<p>Before processing any <code>request</code> parameter, validate the following:</p>
<ul>
  <li>Input type (either String, Number, Boolean, etc.)</li>
  <li>Input boundaries: Check range for numbers, length, and acceptable characters for strings</li>
  <li>Input format: Check for input patterns like emails, IP addresses, etc.</li>
</ul>

<p>You can use <a href="https://www.npmjs.com/package/hpp">hpp</a> npm package for preventing HPP attacks.</p>

<p>Input validation is a broad topic. It can be very tricky especially dealing with rich user content. You can read <a href="https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html">this article</a> for an in-depth review.</p>

<h2 id="sanitize-output">Sanitize Output</h2>
<p>Below sample code exposes a Cross-Site scripting (XSS) vulnerability.</p>
<pre><code class="language-Javascript">const express = require('express')
const app = express()

app.get('/', function (request, response) {
 response.send('Hello ' + request.query.name)
})

app.listen(3000)
</code></pre>

<p>If you run the application and open <code>http://localhost:2000/?name=&lt;script&gt;alert(1)&lt;/script&gt;</code> URL, the <code>alert(1)</code> JavaScript code will be executed. XSS bug allows an attacker to run any client-side code to steal session tokens, passwords or display wrong information.</p>

<p><img src="/assets/img/xss.png" width="960" height="320" alt="Cross-Side Scripting Vulnerability" loading="lazy" style="aspect-ratio: attr(width) / attr(height); height:auto;" /></p>

<p>To prevent the XSS you have to use proper encoding before rendering input parameters in the response. You can use <a href="https://github.com/ESAPI/node-esapi">node-esapi</a> or <a href="https://github.com/component/escape-html">escape-html</a></p>

<p>Below code is a fix for the above XSS:</p>
<pre><code class="language-Javascript">const express = require('express')
var ESAPI = require('node-esapi');
const app = express()

app.get('/', function (request, response) {
 encodedName = ESAPI.encoder().encodeForHTML(request.query.name)
 response.send('Hello ' + encodedName)
})

app.listen(3000)
</code></pre>

<h2 id="use-anti-csrf">Use Anti CSRF</h2>
<p>Processing form data and performing actions only by relying on the form data will cause a Cross-Site Request Forgery (CSRF).
If the same request data (either form data or URL query) causes the same action on your application then you have a CSRF issue. It gets serious when the action is sensitive like, creating a new user or deleting data.</p>

<p>Attackers use CSRF to perform actions on behalf of an authorized user while the user is unaware of this action. Below sample code is an example that kills the app by a CSRF.</p>
<pre><code class="language-Javascript">const express = require('express')
const app = express()

app.get('/', function (request, response) {
 response.send('&lt;h1&gt;Admin Panel&lt;/h1&gt;&lt;a href=/kill&gt;kill&lt;/a&gt;')
})

app.get('/kill', function (request, response) {
 process.exit()
})

app.listen(2000)
</code></pre>

<p>You might wonder that adding cookie-based session management cannot prevent CSRF because Cookies are automatically sent by browsers. To prevent CSRF you should send random tokens within each request and validate the existence of the CSRF token before processing the request.</p>

<p>You can use the <a href="https://www.npmjs.com/package/csurf">csurf</a> npm package for integrating CSRF prevention in your Express application.</p>

<p>In next article we will see how to prevent brute force attacks, command execution and information disclosure vulnerabilities.</p>


      
    
    






















<div class="mv4">
<b>👉 You might also like:</b>

  
    <h3 class="mv2 normal lh-title"><a class="dark-green hover-green link" href="/blog/how-to-secure-your-nodejs-express-javascript-application-part-2">How to Secure your NodeJs Express Javascript Application - part 2</a></h3>
  

  
    <h3 class="mv2 normal lh-title"><a class="dark-green hover-green link" href="/blog/secure-coding-101-how-to-read-and-write-files-securely">Secure Coding 101: How to Read and Write Files Securely</a></h3>
  

  
    <h3 class="mv2 normal lh-title"><a class="dark-green hover-green link" href="/blog/secure-coding-101-how-to-use-random-function">Secure Coding 101: How to Use Random Function</a></h3>
  

  
    <h3 class="mv2 normal lh-title"><a class="dark-green hover-green link" href="/blog/10-secure-coding-best-practices-to-follow-in-every-project">10 Secure Coding Best Practices to Follow in Every Project</a></h3>
  

</div>

    <div class="f4 pt4 mt4">
      
      <a class="link dark-green dim fl" href="/blog/host-header-injection-and-python-tests-with-smartscanner-1-11">← Host Header Injection and Python Tests with SmartScanner 1.11</a>
      
      
      <a class="link dark-green dim fr" href="/blog/smartscanner-now-has-a-64-bit-version-for-windows">SmartScanner now has a 64-bit version for Windows →</a>
      
    </div>
    </div>
  </article>
</main>

<script type="application/ld+json">
[{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "name": "Blog",
    "item": "https://www.thesmartscanner.com/blog/"
  },{
    "@type": "ListItem",
    "position": 2,
    "name": "How to Secure your NodeJs Express Javascript Application - part 1"
  }]
},
{ 
 "@context": "https://schema.org", 
 "@type": "BlogPosting",
 "headline": "How to Secure your NodeJs Express Javascript Application - part 1",
 "image": "/assets/img/express-security.png"
}]
</script>  

<section class="w-100 center ph3 pv4 bg-black-05 tc">
  <div class="mw8 center">
    <h2 class="mt0">Scan security of your website with SmartScanner for free</h2>
    <a href="/download?utm_source=blog&utm_medium=banner" class="f3 link dim ph3 pv2 ma2 ml0 mb0 dib br1 white bg-dark-green">Download</a>      
  </div>
</section>

        <footer class="w-100 f6 pv3 pv4-ns bg-dark-gray moon-gray">
      <div class="mw8 flex flex-wrap justify-between center nt2">
        <div class="flex flex-column mh2 h-100 measure-narrow mv2">
          <h2 class="ma0 f6 lh-copy pv3 pt0-ns"><a href="/blog/" class="light-gray b">Blog</a></h2>
          
          <h3 class="ma0 normal f6 lh-copy"><a href="/blog/online-robots-txt-validator-for-creating-a-secure-robots-txt" class="link dim dib moon-gray link-reset pv1-ns pv2">Online Robots.txt Validator For Creating a Secure Robots.txt</a></h3>
          
          <h3 class="ma0 normal f6 lh-copy"><a href="/blog/web-scanner,-a-must-have-tool-for-web-developers" class="link dim dib moon-gray link-reset pv1-ns pv2">Web Scanner, A Must Have Tool For Web Developers</a></h3>
          
          <h3 class="ma0 normal f6 lh-copy"><a href="/blog/secure-coding-101-how-to-read-and-write-files-securely" class="link dim dib moon-gray link-reset pv1-ns pv2">Secure Coding 101: How to Read and Write Files Securely</a></h3>
          
          <a href="/blog/" class="link dim dib moon-gray link-reset mt2">read more...</a>
        </div>
        <div class="flex flex-column mh2 h-100 measure-narrow mv2">  
          <h2 class="ma0 f6 lh-copy pv3 pt0-ns"><a href="/features" class="light-gray b">Features</a></h2>
          <h4 class="ma0 normal"><a href="/docs/artificial-intelligence-security-scanner" class="link dim dib moon-gray link-reset lh-copy pv1-ns pv2">Artificial Intelligence</a></h4>
          <h4 class="ma0 normal"><a href="/docs/comprehensive-security-tests" class="link dim dib moon-gray link-reset lh-copy pv1-ns pv2">Comprehensive Security Tests</a></h4>
          <h4 class="ma0 normal"><a href="/docs/wordpress-drupal-joomla-cms-security-scanner" class="link dim dib moon-gray link-reset lh-copy pv1-ns pv2">WordPress, Drupal, Joomla! CMS Scanner</a></h4>
          <h4 class="ma0 normal"><a href="/docs/javascript-html5-spa-jamstack-serverless-react-security" class="link dim dib moon-gray link-reset lh-copy pv1-ns pv2">Built for Modern Web</a></h4>
          <a href="/features" class="link dim dib moon-gray link-reset mt2">all features...</a>
        </div>
        <div class="flex flex-column mh2 h-100 measure-narrow mv2">
          <h2 class="ma0 f6 lh-copy pv3 pt0-ns"><a href="/vulnerability-list/" class="light-gray b">Security Vulnerabilities</a></h2>
          <a href="/vulnerability-list/sql-injection" class="link dim dib moon-gray link-reset lh-copy pv1-ns pv2">SQL Injection</a>
          <a href="/vulnerability-list/cross-site-scripting" class="link dim dib moon-gray link-reset lh-copy pv1-ns pv2">Cross Site Scripting (XSS)</a>
          <a href="/vulnerability-list/weak-password" class="link dim dib moon-gray link-reset lh-copy pv1-ns pv2">Weak Password</a>
          <a href="/vulnerability-list/local-file-inclusion" class="link dim dib moon-gray link-reset lh-copy pv1-ns pv2">Path Traversal</a>
          <a href="/vulnerability-list/" class="link dim dib moon-gray link-reset mt2">all security issues...</a>
        </div>
        <div class="flex flex-column mh2 h-100 measure-narrow mv2">
  
          <h2 class="ma0 f6 lh-copy pv3 pt0-ns"><a href="/support" class="light-gray b">Support</a></h2>
          <h2 class="ma0 f6 lh-copy normal"><a href="/docs/" class="link dim dib moon-gray link-reset pv1-ns pv2">Documentation</a></h2>
          <a href="/contact" class="link dim dib moon-gray link-reset lh-copy pv1-ns pv2">Contact form</a>
          <span>
            <a href="mailto:info@thesmartscanner.com" title="Send us an email" class="link dim dib moon-gray link-reset mt2 mr2 lh-copy pv1-ns pv2">
              <svg height="21" viewBox="0 0 21 21" width="21" xmlns="http://www.w3.org/2000/svg"><desc>Email</desc><g fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" transform="translate(3.5 4.5)"><path d="m0 2v8c0 1.1045695.8954305 2 2 2h10c1.1045695 0 2-.8954305 2-2v-8c0-1.1045695-.8954305-2-2-2h-10c-1.1045695 0-2 .8954305-2 2z"></path><path d="m2 3 5 3 5-3"></path></g></svg>
            </a>
            <a href="https://twitter.com/TheSmartScanner" title="Follow us on Twitter" class="link dim dib moon-gray link-reset mt2 lh-copy pv1-ns pv2" target="_blank">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="21" height="21"><desc>Twitter</desc><g fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path></g></svg>
            </a>
          </span>
        </div>
        <div class="flex flex-column mh2 h-100 measure-narrow mv2">  
          <span class="light-gray b lh-copy pv3 pt0-ns">Legal</span>
          <a href="/privacy" class="link dim dib moon-gray link-reset lh-copy pv1-ns pv2">Privacy</a>
          <a href="/terms" class="link dim dib moon-gray link-reset lh-copy pv1-ns pv2">Terms</a>
          <a href="/eula" class="link dim dib moon-gray link-reset lh-copy pv1-ns pv2">EULA</a>
        </div>
      </div>
      <div class="pv4 tc">
        <span>© TheSmartScanner.com</span>
      </div>      
    </footer>

  
  <script defer type="text/javascript" src="/assets/js/prism.js"></script>
  
  <script defer type="text/javascript" id="cookieinfo" data-moreinfo="/privacy#cookies" data-link="inherit" data-bg="#CCC" data-fg="inherit" data-divlinkbg="#137752" data-divlink="#fff" data-opacity="0.5" src="/assets/js/cookieinfo.min.js"></script>    
  </body>
</html>