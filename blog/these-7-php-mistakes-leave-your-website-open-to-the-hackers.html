<!DOCTYPE html>
<html lang="en-US" class="h-100">
  <head>
    <meta charset="UTF-8">
    <title>These 7 PHP mistakes leave your website open to the hackers - SmartScanner</title>
    <meta name="description" content="Make these mistakes and hackers will attack your web application using Cross Site Scripting, SQL Injection, Path Traversal, and other attacks to ta...">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#137752">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="/assets/img/logo.png">
    <link rel="icon" type="image/svg+xml" href="/assets/img/logo.svg">
    <link rel="alternate icon" type="image/png" href="/assets/img/logo.png">
    <meta property="og:title" content="These 7 PHP mistakes leave your website open to the hackers">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://www.thesmartscanner.com/blog/these-7-php-mistakes-leave-your-website-open-to-the-hackers">
    <meta property="og:image" content="/assets/img/common-php-mistakes.webp">
    <meta property="og:description" content="Make these mistakes and hackers will attack your web application using Cross Site Scripting, SQL Injection, Path Traversal, and other attacks to take over your website." />
    <link rel="canonical" href="https://www.thesmartscanner.com/blog/these-7-php-mistakes-leave-your-website-open-to-the-hackers" />
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@TheSmartScanner">
    <meta name="twitter:title" content="These 7 PHP mistakes leave your website open to the hackers">
    <meta name="twitter:url" content="https://www.thesmartscanner.com/blog/these-7-php-mistakes-leave-your-website-open-to-the-hackers" />
    <meta name="twitter:description" content="Make these mistakes and hackers will attack your web application using Cross Site Scripting, SQL Injection, Path Traversal, and other attacks to take over your website.">
    
    <meta name="twitter:image" content="https://www.thesmartscanner.com/assets/img/common-php-mistakes.webp">    
    
    
    <meta name="robots" content="index, follow">
    
    
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LBRWV5BDLZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-LBRWV5BDLZ');
</script>

    <link rel="stylesheet" href="/assets/css/style.css">
  </head>
  <body class="sans-serif lh-easy flex flex-column">
    <header role="banner" class=" black overflow-hidden flex-shrink-none">
      <nav class="w-100 mw8 flex justify-between items-center pa3 center">
        <a class="w-25 flex items-center link" href="/#" title="Home">
          <img src="/assets/img/logo.svg" class="dib w2 h2" width="2rem" height="2rem" alt="SmartScanner Logo">
        </a>
        <div class="w-75 tr black">
          <a class="f6 f5-ns dib mr3 mr4-ns black link bb-animate" href="/pricing">Pricing</a>
          <a class="f6 f5-ns dib mr3 mr4-ns black link bb-animate" href="/features">Features</a>
          <a class="f6 f5-ns dib pa1 ba br1 black link hover-bg-light-green" href="/download">Download</a>
        </div>
      </nav>      
     </header>

    <main class="w-100 mw7 center pv4 flex-grow">
  <article>
    <div>
      <div class="h5 w-100 mb2 cover" style="background-image: url(/assets/img/common-php-mistakes.webp); background-position:center center"></div>
      <div class="flex justify-between f6 gray i mb2 ph3">
        <span><a href="/blog/" class="link gray hover-dark-green">Blog</a><span class="mh2">/</span></span>
        <span onClick="share()" class="gray hover-dark-green cursor-pointer dn-l">
<svg height="21" viewBox="0 0 21 21" width="21" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" transform="translate(3 3)"><path d="m11.5 4.5-3.978-4-4.022 4"></path><path d="m7.522.521v11.979"></path><path d="m4.5 7.5h-2c-1.1045695 0-2 .8954305-2 2v4c0 1.1045695.8954305 2 2 2h10c1.1045695 0 2-.8954305 2-2v-4c0-1.1045695-.8954305-2-2-2h-2"></path></g></svg>
</span>

<script>
async function share() {
  let url = "https://www.TheSmartScanner.com/blog/these-7-php-mistakes-leave-your-website-open-to-the-hackers" || document.URL
  let title = "These 7 PHP mistakes leave your website open to the hackers" || document.title
  let text = `Make these mistakes and hackers will attack your web application using Cross Site Scripting, SQL Injection, Path Traversal, and other attacks to take over your website.`
  
  try {
    await navigator.share({
      url: url,
      title: title,
      text: text
    })
  } catch(err) {
    console.log('sharing not supported', err)
  }
}
</script>
        <span><time datetime="2021-08-15" >15 August 2021</time></span>
      </div>
      <h1 class="mt0 ph3">These 7 PHP mistakes leave your website open to the hackers</h1>
    </div>
    <div class="ph3">
    <p>Make these mistakes and hackers will attack your web application using Cross Site Scripting, SQL Injection, Path Traversal, and other attacks to take over your website.</p>

<p>Let’s review common mistakes and their prevention methods.</p>

<h2 id="1--echo-user-input">1- <code class="language-plaintext highlighter-rouge">Echo</code> user input</h2>
<p>Below code is enough to create a <a href="/vulnerability-list/cross-site-scripting">XSS</a> vulnerability in your website.</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">echo</span> <span class="s1">'&lt;p&gt;'</span> <span class="mf">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'name'</span><span class="p">]</span> <span class="mf">.</span> <span class="s1">'&lt;/p&gt;'</span><span class="p">;</span> <span class="c1">// vulnerable to XSS</span>
</code></pre></div></div>
<p>Never directly use user input for generating response contents. You have to use proper encoding on user input to escape any dangerous code. PHP has the build-in <code class="language-plaintext highlighter-rouge">htmlentities()</code> function to encode html special characters which you can use.</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">echo</span> <span class="s1">'&lt;p&gt;'</span> <span class="mf">.</span> <span class="nb">htmlentities</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'name'</span><span class="p">])</span> <span class="mf">.</span> <span class="s1">'&lt;/p&gt;'</span><span class="p">;</span> <span class="c1">// safe code</span>
</code></pre></div></div>
<blockquote>
  <p>Sometimes user input is used indirectly for generating a page. For example, user input might be saved in a database before being used in the response.</p>
</blockquote>

<h2 id="2--using-user-input-in-file-paths">2- Using user input in file paths</h2>
<p>Generating and using file paths that contain user inputs is one of the most dangerous mistakes that can cause critical vulnerabilities like:</p>

<ul>
  <li><a href="/vulnerability-list/local-file-inclusion">Local File Inclusion</a></li>
  <li><a href="/vulnerability-list/remote-file-inclusion">Remote File Inclusion</a></li>
  <li><a href="/vulnerability-list/remote-file-disclosure">Remote File Disclosure</a></li>
  <li><a href="/vulnerability-list/remote-url-inclusion">Remote URL Inclusion</a></li>
  <li>Path Traversal</li>
</ul>

<p>Below code is an example of a file inclusion vulnerability.</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">include</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'file'</span><span class="p">];</span> <span class="c1">// vulnerable to remote/local file inclusion</span>
</code></pre></div></div>
<p>To prevent file inclusion vulnerabilities:</p>
<ul>
  <li>Resolve all relative paths containing <code class="language-plaintext highlighter-rouge">./</code> and <code class="language-plaintext highlighter-rouge">../</code> to absolute paths and make sure the final file is in the directory where it should be.</li>
  <li>Try to accept only whitelisted inputs whenever possible</li>
  <li>Check for invalid characters in the filename like null byte, questions mark, semicolon, etc.</li>
  <li>Do not include URLs starting with a scheme (http://, ftp://, etc.)</li>
</ul>

<h2 id="3--concatenating-sql-queries-with-user-input">3- Concatenating SQL queries with user input</h2>
<p>Creating SQL queries using user input allows users to manipulate the original SQL command and inject their arbitrary command. This is called <a href="/vulnerability-list/sql-injection">SQL Injection</a>. Hackers can exploit SQL Injection vulnerability to execute commands like <code class="language-plaintext highlighter-rouge">drop</code> on the database or execute system commands.</p>

<p>Example code:</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="nv">$db</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SQLite3</span><span class="p">(</span><span class="s1">'products.db'</span><span class="p">);</span>
<span class="nv">$id</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'id'</span><span class="p">];</span>
<span class="c1">// below line is vulnerable to SQLI</span>
<span class="nv">$name</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="nf">querySingle</span><span class="p">(</span><span class="s2">"SELECT name from products where productId=</span><span class="nv">$id</span><span class="s2">"</span><span class="p">);</span>
<span class="c1">// below line is not vulnerable</span>
<span class="nv">$name</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="nf">querySingle</span><span class="p">(</span><span class="s2">"SELECT name from products where productId='"</span> <span class="mf">.</span>
<span class="nc">SQLite3</span><span class="o">::</span><span class="nf">escapeString</span><span class="p">(</span><span class="nv">$id</span><span class="p">)</span> <span class="mf">.</span> <span class="s2">"'"</span><span class="p">);</span>

<span class="k">echo</span> <span class="nv">$name</span> <span class="p">;</span>
</code></pre></div></div>
<p>It’s always a good practice to use prepared statements for creating SQL queries to prevent SQL Injection. Another method to avoid SQLI is to escape special characters in the user input (like the above example).</p>

<h2 id="4--executing-user-input">4- Executing user input</h2>
<p>Below commands in PHP allow execution of either PHP code or OS commands.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">eval()</code></li>
  <li><code class="language-plaintext highlighter-rouge">preg_replace()</code></li>
  <li><code class="language-plaintext highlighter-rouge">system()</code></li>
  <li><code class="language-plaintext highlighter-rouge">exec()</code></li>
  <li><code class="language-plaintext highlighter-rouge">passthru()</code></li>
  <li><code class="language-plaintext highlighter-rouge">shell_exec()</code></li>
</ul>

<p>Passing user input as arguments to the above functions can cause <a href="/vulnerability-list/os-command-execution">command execution</a> vulnerabilities where hackers can execute arbitrary commands on the server. Consider below code as an example:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ip</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'ip'</span><span class="p">];</span>
<span class="k">echo</span> <span class="nb">exec</span><span class="p">(</span><span class="s2">"ping </span><span class="nv">$ip</span><span class="s2">"</span><span class="p">);</span>
</code></pre></div></div>
<p>The above code is a ping service where users can ping any IP. If a user enters <code class="language-plaintext highlighter-rouge">1 &amp; echo 123</code> as an IP address then the command <code class="language-plaintext highlighter-rouge">echo</code> gets executed on the server.</p>

<p>How to prevent command execution vulnerabilities:</p>
<ul>
  <li>Avoid using functions like <code class="language-plaintext highlighter-rouge">eval()</code>, <code class="language-plaintext highlighter-rouge">system()</code>, …</li>
  <li>Accept whitelisted inputs</li>
  <li>Check inputs for special characters like &amp;, semicolon,</li>
</ul>

<blockquote>
  <p>The <code class="language-plaintext highlighter-rouge">popen()</code> function can also be used for command execution indirectly. So be careful when using it.</p>
</blockquote>

<h2 id="5--redirecting-to-user-input">5- Redirecting to user input</h2>
<p>Redirecting a user in PHP is common and easy. It can be done using below code.</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">header</span><span class="p">(</span><span class="s1">'Location: '</span> <span class="mf">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'url'</span><span class="p">]);</span> <span class="c1">// vulnerable code</span>
</code></pre></div></div>
<p>But this is vulnerable! It can be exploited to redirect the user to any other website.
To prevent <a href="/vulnerability-list/unvalidated-redirection">open redirections</a>, make sure the URL is not an off-site link before redirecting the user.</p>

<h2 id="6--turning-on-error-reporting">6- Turning on error reporting</h2>
<p>PHP errors disclose information like path/files, database errors, OS type, and some other information. Displaying any kind of PHP errors on production helps hackers to break into your website easier.</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">error_reporting</span><span class="p">(</span><span class="kc">E_ALL</span><span class="p">);</span> <span class="c1">// bad code for production</span>
<span class="nb">error_reporting</span><span class="p">();</span> <span class="c1">// safe for production usage</span>
</code></pre></div></div>
<h2 id="7--phpinfo">7- <code class="language-plaintext highlighter-rouge">phpInfo()</code></h2>
<p>The <a href="/vulnerability-list/phpinfo-found"><code class="language-plaintext highlighter-rouge">phpInfo()</code></a> function displays a huge amount of information. PHP version number, active extensions, configurations, and system paths are a few examples of such information. This information can be used by hackers to learn about the server and craft their attacks to be more successful.
To avoid any information disclosure it’s better to never use the <code class="language-plaintext highlighter-rouge">phpInfo()</code> function on production servers.</p>

<h2 id="conclusion">Conclusion</h2>
<p>Dealing with user inputs in PHP applications can be tricky and prone to different vulnerabilities. XSS, SQL Injection, and local file inclusion are a few of explained vulnerabilities related to user inputs. Make sure you have strict checking for user inputs and avoid using risky functions like <code class="language-plaintext highlighter-rouge">eval()</code> and <code class="language-plaintext highlighter-rouge">phpInfo()</code> to have a more secure code.</p>

    






















<div class="mv4">
<b>👉 You might also like:</b>

  
    <h3 class="mv2 normal lh-title"><a class="dark-green hover-green link" href="/blog/how-do-hackers-hack">How do hackers hack websites?</a></h3>
  

  
    <h3 class="mv2 normal lh-title"><a class="dark-green hover-green link" href="/vulnerability-list/local-file-inclusion">Local File Inclusion - Vulnerability</a></h3>
  

  
    <h3 class="mv2 normal lh-title"><a class="dark-green hover-green link" href="/vulnerability-list/remote-file-disclosure">Remote File Disclosure - Vulnerability</a></h3>
  

  
    <h3 class="mv2 normal lh-title"><a class="dark-green hover-green link" href="/vulnerability-list/remote-file-inclusion">Remote File Inclusion - Vulnerability</a></h3>
  

</div>

    <div class="f4 pt4 mt4">
      
      <a class="link dark-green dim fl" href="/blog/44-new-sql-injection-tests-for-wordpress-in-smartscanner-1-8">← 44 New SQL Injection Tests for WordPress in SmartScanner 1.8</a>
      
      
      <a class="link dark-green dim fr" href="/blog/smartscanner-v1-9-as-joomla-security-scanner">SmartScanner v1.9 as Joomla! Security Scanner →</a>
      
    </div>
    </div>
  </article>
</main>    

<script type="application/ld+json">
[{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "name": "Blog",
    "item": "https://www.thesmartscanner.com/blog/"
  },{
    "@type": "ListItem",
    "position": 2,
    "name": "These 7 PHP mistakes leave your website open to the hackers"
  }]
},
{ 
 "@context": "https://schema.org", 
 "@type": "BlogPosting",
 "headline": "These 7 PHP mistakes leave your website open to the hackers",
 "image": "/assets/img/common-php-mistakes.webp"
}]
</script>  

<section class="w-100 center ph3 pv4 bg-black-05 tc">
  <div class="mw8 center">
    <h2 class="mt0">Scan security of your website with SmartScanner for free</h2>
    <a href="/download" class="f3 link dim ph3 pv2 ma2 ml0 mb0 dib br1 white bg-dark-green">Download</a>      
  </div>
</section>

        <footer class="w-100 f6 pv3 pv4-ns bg-dark-gray moon-gray">
      <div class="mw8 flex flex-wrap justify-between center nt2">
        <div class="flex flex-column mh2 h-100 measure-narrow mv2">
          <h2 class="ma0 f6 lh-copy pb2"><a href="/blog/" class="light-gray b">Blog</a></h2>
          
          <h3 class="ma0 normal f6 lh-copy"><a href="/blog/apache-and-express-path-traversal-plus-nginx-restriction-bypass-tests-with-smartscanner" class="link dim dib moon-gray link-reset pb1">Apache and Express Path Traversal plus Nginx Restriction Bypass Tests with SmartScanner</a></h3>
          
          <h3 class="ma0 normal f6 lh-copy"><a href="/blog/complete-guide-to-http-headers-for-securing-websites-cheat-sheet" class="link dim dib moon-gray link-reset pb1">Complete guide to HTTP Headers for securing websites (Cheat Sheet)</a></h3>
          
          <h3 class="ma0 normal f6 lh-copy"><a href="/blog/smartscanner-v1-9-as-joomla-security-scanner" class="link dim dib moon-gray link-reset pb1">SmartScanner v1.9 as Joomla! Security Scanner</a></h3>
          
          <a href="/blog/" class="link dim dib moon-gray link-reset mt2">read more...</a>
        </div>
        <div class="flex flex-column mh2 h-100 measure-narrow mv2">  
          <h2 class="ma0 f6 lh-copy pb2"><a href="/features" class="light-gray b">Features</a></h2>
          <h4 class="ma0 normal"><a href="/docs/artificial-intelligence-security-scanner" class="link dim dib moon-gray link-reset lh-copy pb1">Artificial Intelligence</a></h4>
          <h4 class="ma0 normal"><a href="/docs/comprehensive-security-tests" class="link dim dib moon-gray link-reset lh-copy pb1">Comprehensive Security Tests</a></h4>
          <h4 class="ma0 normal"><a href="/docs/wordpress-drupal-joomla-cms-security-scanner" class="link dim dib moon-gray link-reset lh-copy pb1">WordPress, Drupal, Joomla! CMS Scanner</a></h4>
          <h4 class="ma0 normal"><a href="/docs/javascript-html5-spa-jamstack-serverless-react-security" class="link dim dib moon-gray link-reset lh-copy pb1">Built for Modern Web</a></h4>
          <a href="/features" class="link dim dib moon-gray link-reset mt2">all features...</a>
        </div>
        <div class="flex flex-column mh2 h-100 measure-narrow mv2">
          <h2 class="ma0 f6 lh-copy pb2"><a href="/vulnerability-list/" class="light-gray b">Security Vulnerabilities</a></h2>
          <a href="/vulnerability-list/sql-injection" class="link dim dib moon-gray link-reset lh-copy pb1">SQL Injection</a>
          <a href="/vulnerability-list/cross-site-scripting" class="link dim dib moon-gray link-reset lh-copy pb1">Cross Site Scripting (XSS)</a>
          <a href="/vulnerability-list/weak-password" class="link dim dib moon-gray link-reset lh-copy pb1">Weak Password</a>
          <a href="/vulnerability-list/local-file-inclusion" class="link dim dib moon-gray link-reset lh-copy pb1">Path Traversal</a>
          <a href="/vulnerability-list/" class="link dim dib moon-gray link-reset mt2">all security issues...</a>
        </div>
        <div class="flex flex-column mh2 h-100 measure-narrow mv2">
  
          <h2 class="ma0 f6 lh-copy pb2"><a href="/support" class="light-gray b">Support</a></h2>
          <h2 class="ma0 f6 lh-copy normal"><a href="/docs/" class="link dim dib moon-gray link-reset pb1">Documentation</a></h2>
          <a href="/contact" class="link dim dib moon-gray link-reset lh-copy pb1">Contact form</a>
          <span>
            <a href="mailto:info@thesmartscanner.com" title="Send us an email" class="link dim dib moon-gray link-reset mt2 mr2 lh-copy pb1">
              <svg height="21" viewBox="0 0 21 21" width="21" xmlns="http://www.w3.org/2000/svg"><desc>Email</desc><g fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" transform="translate(3.5 4.5)"><path d="m0 2v8c0 1.1045695.8954305 2 2 2h10c1.1045695 0 2-.8954305 2-2v-8c0-1.1045695-.8954305-2-2-2h-10c-1.1045695 0-2 .8954305-2 2z"></path><path d="m2 3 5 3 5-3"></path></g></svg>
            </a>
            <a href="https://twitter.com/TheSmartScanner" title="Follow us on Twitter" class="link dim dib moon-gray link-reset mt2 lh-copy pb1" target="_blank">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="21" height="21"><desc>Twitter</desc><g fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path></g></svg>
            </a>
          </span>
        </div>
        <div class="flex flex-column mh2 h-100 measure-narrow mv2">  
          <span class="light-gray b lh-copy pb2">Legal</span>
          <a href="/privacy" class="link dim dib moon-gray link-reset lh-copy pb1">Privacy</a>
          <a href="/terms" class="link dim dib moon-gray link-reset lh-copy pb1">Terms</a>
          <a href="/eula" class="link dim dib moon-gray link-reset lh-copy pb1">EULA</a>
        </div>
      </div>
      <div class="pv2 tc">
        <span>© TheSmartScanner.com</span>
      </div>      
    </footer>

  <script type="text/javascript" id="cookieinfo" data-moreinfo="/privacy#cookies" data-link="inherit" data-bg="#CCC" data-fg="inherit" data-divlinkbg="#137752" data-divlink="#fff" data-opacity="0.5" src="/assets/js/cookieinfo.min.js"></script>    
  </body>
</html>